/*! custom-html-audio - v1.0.5 - 2017-12-01 
 *  A custom html5 audio wrapper, that allows styling and functional changes.
 */

"use strict";!function(e,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):e.CustomHtmlAudio=n()}(this,function(){var e=function(e,n){console[n||"info"]("[custom-html-audio.js] %o",e)};return function(n,i){var o,t,d,r,a,s,l,c,u={playing:!1,end:1,loaded:0,seeking:0,currentTime:0},f=function(e){var n=!1;for(var i in e)e[i]!==u[i]&&(u[i]=e[i],n=!0);n&&y()},v=function(e){e=Math.round(e);var n=Math.floor(e/60),i=e-60*n;return n.toFixed()+":"+(i<10?"0":"")+i.toFixed()},_=function(){return isFinite(u.end)?u.end:Math.max(u.currentTime+1,u.loaded)},p=function(e,n){var i=n.offsetWidth;return e.layerX/i*100},y=function(){var e=_();o.classList[u.playing?"add":"remove"]("playing"),s.innerHTML=v(u.currentTime),l.innerHTML=isFinite(u.end)?v(u.end):"",d.style.width=u.loaded/e*100+"%",r.style.width=u.currentTime/e*100+"%",a.style.width=u.seeking+"%"};if(i&&i.src){for((c=document.createElement("audio")).addEventListener("pause",function(){f({playing:!1})}),c.addEventListener("play",function(){f({playing:!0})}),c.addEventListener("ended",function(){f({playing:!1})}),c.addEventListener("error",function(){f({playing:!1})}),["loadedmetadata","progress","timeupdate","durationchange"].forEach(function(e){c.addEventListener(e,function(){var e={currentTime:c.currentTime,end:c.duration};c.buffered.length&&(e.loaded=c.buffered.end(c.buffered.length-1)),f(e)},!1)}),c.src=i.src,c.style.display="none";n.firstChild;)n.removeChild(n.firstChild);n.innerHTML='<div class="audio-controls"><div class="audio-controls__play"></div><div class="audio-controls__text"><span class="audio-controls__currentTime"></span><span class="audio-controls__end"></span></div><div class="audio-controls__time"><div class="audio-controls__loaded"></div><div class="audio-controls__seeking"></div><div class="audio-controls__played"></div></div><div class="audio-controls__noise"></div></div>',n.appendChild(c),o=n.querySelector(".audio-controls__play"),d=n.querySelector(".audio-controls__loaded"),r=n.querySelector(".audio-controls__played"),a=n.querySelector(".audio-controls__seeking"),s=n.querySelector(".audio-controls__currentTime"),l=n.querySelector(".audio-controls__end"),(t=n.querySelector(".audio-controls__time")).addEventListener("click",function(e){c.currentTime=_()*p(e,this)/100}),t.addEventListener("mousemove",function(e){f({seeking:p(e,this)})}),t.addEventListener("mouseenter",function(e){f({seeking:p(e,this)})}),t.addEventListener("mouseleave",function(){f({seeking:0})}),o.addEventListener("click",function(){f({playing:!u.playing}),c[u.playing?"play":"pause"]()})}else e("src for audio is not defined","error")}});