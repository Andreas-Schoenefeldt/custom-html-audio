/*! custom-html-audio - v1.0.3 - 2017-11-28 
 *  A custom html5 audio wrapper, that allows styling and functional changes.
 */

"use strict";!function(e,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):e.CustomHtmlAudio=n()}(this,function(){var e=function(e,n){console[n||"info"]("[custom-html-audio.js] %o",e)};return function(n,i){var t,o,d,r,s,a,c,l,u={playing:!1,end:1,loaded:0,seeking:0,currentTime:0},f=function(e){var n=!1;for(var i in e)e[i]!==u[i]&&(u[i]=e[i],n=!0);n&&m()},v=function(e){e=Math.round(e);var n=Math.floor(e/60),i=e-60*n;return n.toFixed()+":"+(i<10?"0":"")+i.toFixed()},p=function(){return isFinite(u.end)?u.end:Math.max(u.currentTime+1,u.loaded)},_=function(e,n){var i=n.offsetWidth;return(e.pageX-n.offsetLeft)/i*100},m=function(){var e=p();t.classList[u.playing?"add":"remove"]("playing"),a.innerHTML=v(u.currentTime),c.innerHTML=isFinite(u.end)?v(u.end):"",d.style.width=u.loaded/e*100+"%",r.style.width=u.currentTime/e*100+"%",s.style.width=u.seeking+"%"};if(i&&i.src){for((l=document.createElement("audio")).addEventListener("pause",function(){f({playing:!1})}),l.addEventListener("play",function(){f({playing:!0})}),l.addEventListener("ended",function(){f({playing:!1})}),l.addEventListener("error",function(){f({playing:!1})}),["loadedmetadata","progress","timeupdate","durationchange"].forEach(function(e){l.addEventListener(e,function(){var e={currentTime:l.currentTime,end:l.duration};l.buffered.length&&(e.loaded=l.buffered.end(l.buffered.length-1)),f(e)},!1)}),l.src=i.src,l.style.display="none";n.firstChild;)n.removeChild(n.firstChild);n.innerHTML='<div class="audio-controls"><div class="audio-controls__play"></div><div class="audio-controls__text"><span class="audio-controls__currentTime"></span><span class="audio-controls__end"></span></div><div class="audio-controls__time"><div class="audio-controls__loaded"></div><div class="audio-controls__seeking"></div><div class="audio-controls__played"></div></div><div class="audio-controls__noise"></div></div>',n.appendChild(l),t=n.querySelector(".audio-controls__play"),d=n.querySelector(".audio-controls__loaded"),r=n.querySelector(".audio-controls__played"),s=n.querySelector(".audio-controls__seeking"),a=n.querySelector(".audio-controls__currentTime"),c=n.querySelector(".audio-controls__end"),(o=n.querySelector(".audio-controls__time")).addEventListener("click",function(e){l.currentTime=p()*_(e,this)/100}),o.addEventListener("mousemove",function(e){f({seeking:_(e,this)})}),o.addEventListener("mouseenter",function(e){f({seeking:_(e,this)})}),o.addEventListener("mouseleave",function(){f({seeking:0})}),t.addEventListener("click",function(){f({playing:!u.playing}),l[u.playing?"play":"pause"]()})}else e("src for audio is not defined","error")}});